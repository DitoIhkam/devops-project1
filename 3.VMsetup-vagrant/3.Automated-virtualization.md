![alt text](?raw=true)
# Vagrant untuk Manajemen Virtual Machine (VM)

Dokumentasi ini menjelaskan bagaimana Vagrant dapat digunakan untuk mengelola dan mengotomatisasi pembuatan lingkungan virtual (VM), serta bagaimana cara memecahkan masalah umum dalam manajemen VM.

## Masalah Manajemen VM

Beberapa masalah yang sering dihadapi dalam manajemen VM adalah:

1. **Instalasi OS**: Memerlukan waktu dan usaha yang signifikan untuk menginstal sistem operasi di setiap VM.
2. **Waktu yang Terbuang**: Proses instalasi yang memakan waktu dan proses manual.
3. **Kesalahan Manusia**: Proses manual sangat rentan terhadap kesalahan manusia.
4. **Kesulitan Mereplikasi Banyak VM**: Menyalin pengaturan VM ke banyak instansi dapat menjadi hal yang sulit.
5. **Dokumentasi Pengaturan**: Mencatat dan mendokumentasikan pengaturan VM yang dilakukan secara manual sangat sulit.

## Solusi dengan Vagrant

Vagrant menawarkan solusi untuk masalah-masalah ini dengan menyediakan alat untuk mengelola VM secara otomatis.

### Fitur Utama Vagrant:

1. **Tidak Perlu Instalasi OS**:
   - Vagrant memungkinkan penggunaan **VM Images** (image sistem operasi) yang sudah tersedia.
   - Tersedia box-box yang dapat diunduh secara gratis melalui [Vagrant Cloud](https://portal.cloud.hashicorp.com/vagrant/discover).

2. **Vagrantfile**:
   - Vagrant menggunakan **Vagrantfile** untuk mengonfigurasi dan mengatur semua pengaturan VM.
   - Semua perubahan dan provisioning VM dapat dilakukan melalui file ini.

3. **Perintah Sederhana**:
   - `vagrant init {{boxname}}`: Inisialisasi Vagrant dengan box tertentu.
contoh : vagrant init eurolinux-vagrant/centos-stream-9 --box-version 9.0.48
   - `vagrant up`: Menjalankan VM.
   - `vagrant status`: Melihat status vm yang berjalan
   - `vagrant ssh`: Akses SSH ke VM.
   - `vagrant halt`: Mematikan VM.
   - `vagrant reload`: Menjalankan VM + menerapkan modifikasi dari vagrant file
   - `vagrant box list` digunakan untuk melihat daftar box yang telah diunduh
   - `vagrant status`: Menampilkan status dari VM di direktori proyek saat ini vm yang sedang berjalan, dihentikan, atau belum dibuat.
- `vagrant global-status`: menampilkan daftar semua VM yang pernah dibuat oleh Vagrant di sistem Anda, terlepas dari direktori proyeknya.
-  `vagrant global-status --prune`: 
mirip dengan vagrant global-status. Opsi ini akan membersihkan daftar VM yang tidak lagi ada (misalnya, VM yang sudah dihapus tetapi masih terdaftar dalam daftar global-status).
   - `vagrant destroy`: Menghancurkan VM.

## Arsitektur Vagrant

Vagrant memiliki beberapa komponen utama yang bekerja bersama untuk membuat dan mengelola mesin virtual (VM) dengan mudah. Berikut adalah gambaran dari arsitektur Vagrant:

- Vagrant Command Line Interface (CLI): Ini adalah antarmuka yang digunakan pengguna untuk berinteraksi dengan Vagrant. Pengguna memberikan perintah melalui terminal, seperti vagrant up, vagrant halt, vagrant destroy, dll. Vagrant CLI ini akan menjalankan perintah sesuai dengan konfigurasi yang ada di dalam Vagrantfile.

- Vagrantfile: File konfigurasi yang digunakan oleh Vagrant untuk mendefinisikan pengaturan lingkungan virtual. Di dalam Vagrantfile, Anda bisa mengatur box (sistem operasi dasar), penyedia (provider) untuk virtualisasi (misalnya VirtualBox, VMware), pengaturan jaringan, pengaturan port, serta pengaturan lainnya yang diperlukan oleh VM.

- Providers: Providers adalah penyedia virtualisasi yang digunakan untuk menjalankan dan mengelola VM. Vagrant mendukung beberapa provider, seperti:

  - VirtualBox: Salah satu provider yang paling sering digunakan, terutama karena gratis dan open-source.

  - VMware: Untuk lingkungan VMware yang lebih besar dan lebih kompleks (dengan lisensi berbayar).

  - Hyper-V: Penyedia untuk sistem operasi Windows.

  - Docker: Vagrant juga dapat digunakan untuk mengelola container Docker.

- Boxes: Box adalah templat dasar atau citra dari sistem operasi yang digunakan oleh Vagrant untuk membuat VM. Box bisa berupa gambar CentOS, Ubuntu, Debian, dll. Anda bisa mencari dan mengunduh box dari Vagrant Cloud, yang adalah repositori online untuk box-box tersebut. Box ini seperti "template" yang digunakan untuk membuat VM baru.


        +--------------------+
        |  Vagrant CLI (Perintah) |
        +--------------------+
                 |
                 v
        +--------------------+
        |   Vagrantfile      |
        | (Konfigurasi VM)   |
        +--------------------+
                 |
                 v
        +---------------------+  <----->  +----------------------+
        |     Providers       |            |      Boxes (Template) |
        | (VirtualBox, VMware, |            | (Ubuntu, CentOS, dll.)|
        |  Docker, Hyper-V)    |            +----------------------+
        +---------------------+
                 |
                 v
        +----------------------+
        |   Virtual Machine    |
        |   (VM)               |
        +----------------------+


## Langkah-langkah Penggunaan Vagrant

Berikut adalah langkah-langkah untuk menggunakan Vagrant dalam proyek ini:

1. **Persiapkan Folder dan Vagrantfile**:
   - Siapkan folder yang berisi file `Vagrantfile` yang mengonfigurasi VM, bisa dengan menggunakan `vagrant init {{boxname}}`

2. **Menjalankan VM dengan vagrant up**:
   - Gunakan perintah `vagrant up` untuk menyalakan VM berdasarkan pengaturan di Vagrantfile.

3. **Akses VM dengan ssh**:
   - Gunakan perintah `vagrant ssh` untuk mengakses VM melalui SSH setelah VM berjalan.

4. **Matikan dan Hancurkan VM**:
   - Setelah selesai, matikan VM dengan perintah `vagrant halt`.
   - Jika ingin menghapus VM, gunakan perintah `vagrant destroy`.




## Praktik Penggunaan Vagrant dengan CentOS 9

### 1. Membuat Folder untuk CentOS dan Ubuntu

Dalam praktek ini, saya membuat folder untuk dua sistem operasi, yaitu CentOS dan Ubuntu. Namun, karena keterbatasan waktu, saya hanya menggunakan CentOS 9 dan tidak melanjutkan dengan Ubuntu.

(gambar 2.1)
![alt text](https://github.com/DitoIhkam/vprofile/blob/learn-devops/3.VMsetup-vagrant/image/3.1.Lokasi-Vagrant-PertamaKali.png?raw=true)

### 2. Mencari Box/Image Vagrant di Vagrant Cloud

Untuk memulai, kita perlu mencari box/image Vagrant yang akan digunakan. Dalam hal ini, saya mencari CentOS 9 di Vagrant Cloud.

Setelah menemukan box yang sesuai, kita menggunakan perintah vagrant init untuk menginisialisasi box CentOS tersebut menggunakan `vagrant init eurolinux-vagrant/centos-stream-9 --box-version 9.0.48`. Didalam konfigurasi `Vagrantfile` yang otomatis muncul setelah di initialize, biarkan konfigurasi tanpa dimodifikasi.
(gambar 2.2-2.4)
![alt text](https://github.com/DitoIhkam/vprofile/blob/learn-devops/3.VMsetup-vagrant/image/3.2.Vagrant-cloud.png?raw=true)
![alt text](https://github.com/DitoIhkam/vprofile/blob/learn-devops/3.VMsetup-vagrant/image/3.3.centos9-box.png?raw=true)
![alt text](https://github.com/DitoIhkam/vprofile/blob/learn-devops/3.VMsetup-vagrant/image/3.4.vagrant-init.png?raw=true)

### 3. Menggunakan vagrant up

Setelah berhasil menginisialisasi box, kita menjalankan perintah `vagrant up` untuk menyalakan virtual machine (VM).

Karena Vagrant tidak diarahkan ke platform virtualisasi tertentu seperti VMware atau VirtualBox, secara default Vagrant akan menggunakan VirtualBox sebagai penyedia (provider) virtualisasi. Konfigurasi seteleh di init bisa saja diatur vm mau diarahkan ke vmwaren/virtualbox/lainnya, tetapi praktek ini kita hanya menggunakan default saja.
(gambar 2.5)
![alt text](https://github.com/DitoIhkam/vprofile/blob/learn-devops/3.VMsetup-vagrant/image/3.5.Vagrant-Up-Auto-virtualbox.png?raw=true)

### 4. Memeriksa Status VM dan login SSH

Gunakan perintah `vagrant status` untuk memeriksa status VM. Jika VM sedang berjalan, statusnya akan menunjukkan "running".

Setelah VM aktif, Anda dapat masuk ke dalamnya menggunakan SSH dengan perintah `vagrant ssh`, perlu diketahui apabila lebih dari 1 vm, ssh harus ditentukan namanya. misal ketika nanti akan ssh akan ada `vagrant ssh vm1` atau `vagrant ssh vm2` yang akan kita pelajari di materi berikutnya dengan mengedit konfigurasi `Vagrantfile`.

Setelah berhasil login, Anda dapat menggunakan perintah pwd untuk melihat direktori tempat Anda berada.

Anda juga dapat menggunakan sudo untuk mendapatkan akses root dan menjalankan perintah-perintah yang membutuhkan hak akses administratif.

Untuk keluar dari sesi SSH, cukup ketik perintah `exit`.
(gambar 2.6)
![alt text](https://github.com/DitoIhkam/vprofile/blob/learn-devops/3.VMsetup-vagrant/image/3.6.vagrant-status-n-login-test.png?raw=true)

### 6. Menghentikan VM

Untuk menghentikan VM, Anda dapat menggunakan perintah vagrant halt. Perintah ini akan mematikan VM dengan aman.
(gambar 2.7)
![alt text](https://github.com/DitoIhkam/vprofile/blob/learn-devops/3.VMsetup-vagrant/image/3.7.vagrant-halt.png?raw=true)

### 7. Memeriksa Status setelah VM Dihentikan dan Menyalakan Kembali VM

Setelah VM dimatikan, Anda dapat memeriksa statusnya menggunakan vagrant status. Status VM akan menunjukkan bahwa VM tersebut tidak aktif.

Untuk menyalakan kembali VM, gunakan perintah vagrant up. Jika Anda ingin mengubah konfigurasi di Vagrantfile dan menerapkan perubahan tersebut, Anda bisa menggunakan perintah vagrant reload. Perintah ini akan memulai ulang VM, baik ketika VM sedang aktif maupun tidak aktif, dan menerapkan perubahan yang ada di Vagrantfile.

(gambar 2.8)
![alt text](https://github.com/DitoIhkam/vprofile/blob/learn-devops/3.VMsetup-vagrant/image/3.8.Vagrant-status-vagrant-up-vagrant-reload-question.png?raw=true)

### 8. Menghapus VM

Setelah selesai menggunakan VM, Anda dapat menghapusnya dengan perintah vagrant destroy. Setelah itu, jalankan perintah vagrant status untuk memastikan bahwa VM sudah tidak ada lagi.
(gambar 2.9)
![alt text](https://github.com/DitoIhkam/vprofile/blob/learn-devops/3.VMsetup-vagrant/image/3.9.vagrant-destroy-vagrant-status.png?raw=true)

### 9. Menampilkan Status Semua VM

Perintah vagrant status hanya akan menampilkan status VM yang ada di dalam folder yang memiliki Vagrantfile.

Untuk melihat status dari semua VM di sistem, gunakan perintah vagrant global-status. Perintah ini akan menunjukkan status semua VM, tidak hanya yang ada di folder tertentu.

Kita juga dapat menambahkan opsi --prune pada perintah vagrant global-status untuk menghapus entri status VM yang sudah dihancurkan atau tidak lagi ada.
(gambar 2.10)
![alt text](https://github.com/DitoIhkam/vprofile/blob/learn-devops/3.VMsetup-vagrant/image/3.10.vagrant-up-halt-global-status-prune.png?raw=true)

### 10. Melihat Ketersediaan Box yang Sudah Diunduh

Untuk melihat daftar box yang sudah diunduh sebelumnya, gunakan perintah vagrant box list. Perintah ini akan menampilkan semua box yang sudah tersedia di sistem Anda.
(gambar 2.11)
![alt text](https://github.com/DitoIhkam/vprofile/blob/learn-devops/3.VMsetup-vagrant/image/3.11.vagrant-box-list.png?raw=true)

### Penjelasan Tambahan:
- Vagrantfile: Sebuah file konfigurasi yang digunakan oleh Vagrant untuk mendefinisikan pengaturan VM, seperti box yang digunakan, pengaturan jaringan, dan penyedia virtualisasi (VirtualBox, VMware, dll).

- Provider: Penyedia virtualisasi yang digunakan oleh Vagrant, misalnya VirtualBox atau VMware.

- Vagrant Cloud: Platform tempat Vagrant mencari dan menyimpan box yang dapat digunakan untuk membuat virtual machine.
